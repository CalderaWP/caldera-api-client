<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="./">
  <title data-ice="title">Manual | Caldera API Client</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="JavaScript API client for Caldera Forms"><meta property="og:type" content="website"><meta property="og:url" content="http://calderalabs.org/caldera-api-client/"><meta property="og:site_name" content="Caldera API Client"><meta property="og:title" content="Caldera API Client"><meta property="og:image" content="https://calderaforms.com/wp-content/themes/caldera-forms-dot-com/img/caldera-forms-logo.svg"><meta property="og:description" content="JavaScript API client for Caldera Forms"><meta property="og:author" content="http://calderalabs.org"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Caldera API Client"><meta property="twitter:description" content="JavaScript API client for Caldera Forms"><meta property="twitter:image" content="https://calderaforms.com/wp-content/themes/caldera-forms-dot-com/img/caldera-forms-logo.svg"></head>
<body class="layout-container manual-root manual-index" data-ice="rootContainer">

<header>
  <a href="./" style="display: flex; align-items: center;"><img src="./image/brand_logo.svg" style="width:34px;"></a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/calderawp/caldera-api-client"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div class="manual-toc-root">
  
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/overview.html"><a href="manual/overview.html" data-ice="link">Caldera API Overview</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/overview.html"><a href="manual/overview.html#provided-clients" data-ice="link">Provided Clients</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/overview.html"><a href="manual/overview.html#forms-clients" data-ice="link">Forms Clients</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/overview.html"><a href="manual/overview.html#privacy-settings" data-ice="link">Privacy Settings</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/overview.html"><a href="manual/overview.html#cf-pro-local-settings-client" data-ice="link">CF Pro Local Settings Client</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/overview.html"><a href="manual/overview.html#cf-pro-client" data-ice="link">CF Pro Client</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/overview.html"><a href="manual/overview.html#entries" data-ice="link">Entries</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/overview.html"><a href="manual/overview.html#acceptable-usage-of-admin-clients" data-ice="link">Acceptable Usage Of Admin Clients</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/overview.html"><a href="manual/overview.html#usage" data-ice="link">Usage</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/overview.html"><a href="manual/overview.html#import-with-webpack" data-ice="link">Import With webpack</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/overview.html"><a href="manual/overview.html#full-example" data-ice="link">Full Example</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/overview.html"><a href="manual/overview.html#wordpress-admin-clients" data-ice="link">WordPress Admin Clients</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/overview.html"><a href="manual/overview.html#get-forms-or-a-specific-form-with-the-forms-client" data-ice="link">Get Forms or A Specific Form With The Forms Client</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/overview.html"><a href="manual/overview.html#read-or-update-privacy-settings" data-ice="link">Read or Update Privacy Settings</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/overview.html"><a href="manual/overview.html#read-or-update-caldera-forms-pro-local-settings" data-ice="link">Read or Update Caldera Forms Pro Local Settings</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/overview.html"><a href="manual/overview.html#caldera-forms-pro-admin-client" data-ice="link">Caldera Forms Pro Admin Client</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/overview.html"><a href="manual/overview.html#testing" data-ice="link">Testing</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/overview.html"><a href="manual/overview.html#mocking-requests" data-ice="link">Mocking Requests</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/overview.html"><a href="manual/overview.html#examples-of-mocking-fetch" data-ice="link">Examples of Mocking Fetch</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/overview.html"><a href="manual/overview.html#helpful-links-about-fetch-and-testing-with-fetch" data-ice="link">Helpful Links About Fetch and Testing With Fetch</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.html"><a href="manual/README.html" data-ice="link">caldera-api-client</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.html"><a href="manual/README.html#usage" data-ice="link">Usage</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.html"><a href="manual/README.html#install" data-ice="link">Install</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.html"><a href="manual/README.html#development-requirements" data-ice="link">Development Requirements</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.html"><a href="manual/README.html#testing" data-ice="link">Testing</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.html"><a href="manual/README.html#scripts" data-ice="link">Scripts</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.html"><a href="manual/README.html#build-for-release" data-ice="link">Build for release</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.html"><a href="manual/README.html#tests" data-ice="link">Tests</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.html"><a href="manual/README.html#type-checking-with-flow" data-ice="link">Type-checking With Flow</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.html"><a href="manual/README.html#lint-code" data-ice="link">Lint Code</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.html"><a href="manual/README.html#generate-documentation" data-ice="link">Generate Documentation</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.html"><a href="manual/README.html#release-to-npm" data-ice="link">Release To npm</a></li>
</ul>
  </div>
</div>
</nav>

<div class="content" data-ice="content"><div class="github-markdown">
  <div class="manual-user-index" data-ice="manualUserIndex"><h1 id="caldera-api-client-documentation">Caldera API Client Documentation</h1><p>This library was first used in Caldera Forms <a href="https://github.com/CalderaWP/Caldera-Forms/pull/2611">in this pull request</a></p>
<p>[Caldera Forms REST API documentation])(<a href="https://calderaforms.com/doc/caldera-forms-rest-api/">https://calderaforms.com/doc/caldera-forms-rest-api/</a>)</p>
</div>

  

  <div class="manual-cards">
    
  <div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Caldera API Overview</h1><h2>Provided Clients</h2><h3>Forms Clients</h3><p><strong>Admin Client</strong></p><p>Get form configs and collections of forms config from a WordPress site.</p><h3>Privacy Settings</h3><p><strong>Admin Client</strong></p><p>Get and update a WordPress site&apos;s privacy settings</p><h3>CF Pro Local Settings Client</h3><p><strong>Admin Client</strong></p><p>Get and update a WordPress site&apos;s CF Pro settings</p><h3>CF Pro Client</h3><p><strong>Admin Client</strong>
Get an account&apos;s layouts from CF Pro. Client is designed for remote admin access to Caldera Forms Pro.</p><h3>Entries</h3><p>Get entries of a form.</p><h4>Acceptable Usage Of Admin Clients</h4><p>Admin clients are designed to be used on pages that only someone who has access to the account or owns the current site. These clients will expose secret keys, so should only be employed where the use knows these secrets.</p><p>OK: Caldera Forms settings page that is accessible only to admin users
OK: Caldera Forms Pro UI that requires login
NOT OK: Any publicly addressable page.
NOT OK: Front-end rendering of a Caldera Form.</p><h2>Usage</h2><h3>Import With webpack</h3><p><code>import * as calderaApiClient from &apos;@caldera-labs/api-client&apos;;</code></p><h4>Full Example</h4><pre><code class="lang-js"><code class="source-code prettyprint">import * as calderaApiClient from &apos;@caldera-labs/api-client&apos;;
const formsAdminApiClient = calderaApiClient.wpClientFactory(
    &apos;https://hiroy.club/wp-json/cf-api/v2&apos;, //root of Caldera Forms REST API namepace
    &apos;12345&apos;, //the nonce for REST API cookie authentication
    &apos;forms&apos; //type of client to get
);</code>
</code></pre><h3>WordPress Admin Clients</h3><ul>
<li><p>Get or update Caldera Forms form configs or other settings.</p>
</li>
<li><p><a href="https://developer.wordpress.org/rest-api/using-the-rest-api/authentication/#cookie-authentication">Uses REST API cookie authentication</a></p>
</li>
</ul><h4>Get Forms or A Specific Form With The Forms Client</h4><pre><code class="lang-js"><code class="source-code prettyprint">//create forms client
const client = wpClientFactory(
    &apos;https://hiroy.club/wp-json/cf-api/v2&apos;, //root of Caldera Forms REST API namepace
    &apos;12345&apos;, //the nonce for REST API cookie authentication
    &apos;forms&apos; //type of client to get
);
//Get page 1 of forms
client.getForms(1).then(forms =&gt; {
    console.log(forms); //Array of forms
});

//Get page 2 of forms
client.getForms(2).then(forms =&gt; {
    console.log(forms); //Array of forms
});

//Get form CF123456&apos;s configuration
client.getForm(&apos;CF123456&apos;).then(form =&gt; {
    console.log(form); //Object containing form configuration
});</code>
</code></pre><h4>Read or Update Privacy Settings</h4><pre><code class="lang-js"><code class="source-code prettyprint">//create forms client
const client = wpClientFactory(
    &apos;https://hiroy.club/wp-json/cf-api/v2&apos;, //root of Caldera Forms REST API namepace
    &apos;12345&apos;, //the nonce for REST API cookie authentication
    &apos;privacy&apos; //type of client to get ask for &quot;privacy&quot;
);
//Get privacy settings of form with ID CF12345
client.getSettings(&apos;CF12345&apos;).then(settings =&gt; {
    console.log(settings); //Object with basic form info and the privacy settings
});

//Update setting of form with ID CF12345
client.updateSettings(&apos;CF12345&apos;,{
    &apos;emailIdentifyingFields&apos;: [&apos;fld_4917648&apos;],
    &apos;piiFields&apos;: [&apos;fld_9899154&apos;, &apos;fld_4917648&apos;],
    &apos;privacyExporterEnabled&apos;: true
}).then(settings =&gt; {
    console.log(settings); //Object with basic form info and the privacy settings
});
</code>
</code></pre><h4>Read or Update Caldera Forms Pro Local Settings</h4><h3>Caldera Forms Pro Admin Client</h3><pre><code class="lang-js"><code class="source-code prettyprint">const client = new ProClient(&apos;https://app.calderaformspro.com&apos;);
client.setPublicKey(&apos;12345&apos;);
client.setSecretKey(&apos;abcd1&apos;);
client.getLayouts().then(res =&gt; {
    expect(res).toEqual(layouts);
});</code>
</code></pre><h2>Testing</h2><h3>Mocking Requests</h3><p>All HTTP requests use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a>.</p><p>You can test using <a href="https://github.com/jefflau/jest-fetch-mock">jest-fetch-mock</a></p><h4>Examples of Mocking Fetch</h4><ul>
<li><p>Mocking Fetch, in general:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">describe(&apos;testing api&apos;, () =&gt; {

beforeEach(() =&gt; {
  fetch.resetMocks()
});

it(&apos;Gets data from API&apos;, () =&gt; {
  fetch.mockResponseOnce(JSON.stringify({ data: &apos;12345&apos; }))

  //assert on the response
  fetch(&apos;https://hiroy.club/api&apos;).then(res =&gt; {
    expect(res.data).toEqual(&apos;12345&apos;)
  });

  //assert on the times called and arguments given to fetch
  expect(fetch.mock.calls.length).toEqual(1);
})
})</code>
</code></pre>
</li>
<li><p>Mocking API call that uses fetch.</p>
</li>
<li><p>Since our API clients use fetch, we need to setup a fetch mock before calling a client function.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">describe(&apos;Forms API&apos;, () =&gt; {
  //Data likely to be reused in multiple tests.
  const form = {ID: &apos;CF1&apos;};
  const formsApiRoute = &apos;https://wordpress.test/wp-json/cf-api/v2/forms&apos;;

  //Reset before each test in this describe() closure for isolation
  beforeEach(() =&gt; {
      fetch.resetMocks()
  });

  //Test once call per it() closure.
  it(&apos;Gets data from API&apos;, () =&gt; {
      fetch.mockResponseOnce(JSON.stringify(form));

      //Fetch and wait for response.
      client.getForm(&apos;CF1&apos;).then(response =&gt; {
          expect(response).toEqual(form); //test response
      }).catch((error) =&gt; {
          console.log(error); //log error
      });

      //Make sure it ran.
      expect(fetch.mock.calls.length).toEqual(1);
  })
});</code>
</code></pre>
</li>
</ul><h4>Helpful Links About Fetch and Testing With Fetch</h4><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">MDN Fetch docs</a></li>
<li><a href="https://davidwalsh.name/fetch">David Walsh blog post about Fetch</a></li>
</ul></div>
        <a data-ice="link" href="manual/overview.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>caldera-api-client</h1><p>JavaScript API client for [Caldera Forms REST API])(<a href="https://calderaforms.com/doc/caldera-forms-rest-api/">https://calderaforms.com/doc/caldera-forms-rest-api/</a>) and Caldera Forms Pro REST API.</p><p><a href="https://travis-ci.org/calderawp/caldera-api-client"><img src="https://travis-ci.org/calderawp/caldera-api-client.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/github/calderawp/caldera-api-client?branch=master"><img src="https://coveralls.io/repos/github/calderawp/caldera-api-client/badge.svg?branch=master" alt="Coverage Status"></a></p><p>&#x1F30B; <a href="http://calderalabs.org/caldera-api-client/">Documentation</a></p><h3>Usage</h3><p>Create a form client and use it to get page one of form configs via API</p><pre><code class="lang-js"><code class="source-code prettyprint">import * as calderaApiClient from &apos;@caldera-labs/api-client&apos;;
const formsAdminApiClient = calderaApiClient.wpClientFactory(
    &apos;https://hiroy.club/wp-json/cf-api/v2&apos;, //root of Caldera Forms REST API namepace
    &apos;12345&apos;, //the nonce for REST API cookie authentication
    &apos;forms&apos; //type of client to get
);
let forms = [];
formsAdminApiClient(page).then(r =&gt; {
    forms = r;
}).catch(error =&gt; {
    console.log(error);
    throw error;
});</code>
</code></pre><p>See: <a href="http://calderalabs.org/caldera-api-client/manual/overview.html#usage">http://calderalabs.org/caldera-api-client/manual/overview.html#usage</a></p><h2>Install</h2><p><code>npm i -D @caldera-labs/api-client</code></p><h3>Development Requirements</h3><ul>
<li><a href="https://www.npmjs.com/get-npm">npm</a></li>
<li><a href="https://yarnpkg.com/lang/en/docs/install/#mac-stable">Yarn</a></li>
<li><a href="">Git</a></li>
<li><a href="https://flow.org/en/docs/install/">Flow</a> - Type Checking</li>
</ul><h2>Testing</h2><p>We use <a href="https://facebook.github.io/jest/">Facebook Jest</a> for unit tests. Test go in the directory <code>__tests__</code>.</p><ul>
<li>Run test watcher<pre><code><code class="source-code prettyprint">yarn test</code>
</code></pre></li>
</ul><p>Make sure to review the docs on <a href="http://calderalabs.org/caldera-api-client/manual/overview.html#mocking-requests">testing requests</a></p><h2>Scripts</h2><h3>Build for release</h3><ul>
<li><code>yarn build</code></li>
<li>Runs tests, and flow type checks and Babel compiles with minification and source map.</li>
</ul><p>This script calls a pre, compile, and post subcommands.  For consistency, please call other scripts at those three events.</p><h3>Tests</h3><ul>
<li><code>yarn test</code> : Test Watcher</li>
<li><code>npm test:once</code> : Run Tests once</li>
</ul><h3>Type-checking With Flow</h3><ul>
<li><code>yarn flow</code></li>
</ul><h3>Lint Code</h3><ul>
<li>Lint code once:</li>
<li><code>yarn lint</code></li>
<li>Lint and fix code once</li>
<li><code>yarn lint:fix</code></li>
<li>Run linter and fixer watch</li>
<li><code>yarn lint:watch</code></li>
</ul><h3>Generate Documentation</h3><ul>
<li><code>npm run documentation</code></li>
<li>Generates documentation from inline docs</li>
<li>Generates documentation from markdown files in /manual</li>
</ul><h3>Release To npm</h3><p>Must be <a href="https://docs.npmjs.com/cli/adduser">logged in as project maintainer via npm cli</a></p><ul>
<li><code>yarn release</code></li>
</ul></div>
        <a data-ice="link" href="manual/README.html"></a>
      </div>
    </div>
</div>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
